drop schema if exists projectschema cascade;
create schema projectschema;
set search_path to projectschema;

create domain ageranges as varchar(20)
    not null
    check (value in ('0-4', '5-14', '15plus'));

create domain Sex as varchar(20)
    not null
    check (value in ('m', 'f', 'a'));

create domain HealthSector as varchar(20)
    not null
    check (value in ('research', 'laboratory equipments', 
    'patient support','budget line items', 'treatment types'));



DROP TABLE IF EXISTS TB_Fatality CASCADE;
CREATE TABLE TB_Fatality (
    country VARCHAR(100) NOT NULL,
    year INT NOT NULL,
    fatalityRate FLOAT NOT NULL,
    primary key(country, year)
);


DROP TABLE IF EXISTS TB_By_Country CASCADE;
CREATE TABLE TB_By_Country (
    country VARCHAR(100) NOT NULL,
    year INT NOT NULL,
    ageRange ageranges,
    sex Sex,
    tbRate FLOAT NOT NULL,
    primary key(country, year, ageRange, sex),
    foreign key (country, year) references TB_Fatality
);


DROP TABLE IF EXISTS CountryGDP CASCADE;
CREATE TABLE CountryGDP (
    country VARCHAR(100) NOT NULL,
    year INT NOT NULL,
    GDP FLOAT NOT NULL,
    primary key(country, year),
    foreign key (country, year) references TB_Fatality(country, year)
);

DROP TABLE IF EXISTS CountryGDPPC CASCADE;
CREATE TABLE CountryGDPPC (
    country VARCHAR(100) NOT NULL,
    year INT NOT NULL,
    GDPPerCap FLOAT NOT NULL,
    primary key(country, year),
    foreign key (country, year) references TB_Fatality(country, year)
);

DROP TABLE IF EXISTS TBComorbidity CASCADE;
CREATE TABLE TBComorbidity (
    country VARCHAR(100) NOT NULL,
    year INT NOT NULL,
    cName VARCHAR(250) NOT NULL,
    comorbidityRate FLOAT NOT NULL,
    primary key(country, year, cName),
    foreign key (country, year) references TB_Fatality(country, year)
);

DROP TABLE IF EXISTS DiseaseCausedDeaths CASCADE;
CREATE TABLE DiseaseCausedDeaths (
    year INT NOT NULL,
    diseaseName VARCHAR(250) NOT NULL,
    totalDeaths INT NOT NULL,
    primary key(year),
    foreign key (year) references TB_Fatality (year)
);

DROP TABLE IF EXISTS HealthCareFunding CASCADE;
CREATE TABLE HealthCareFunding (
    country VARCHAR(100) NOT NULL,
    year INT NOT NULL,
    healthcareSector HealthSector,
    amount FLOAT NOT NULL,
    primary key(country, year),
    foreign key (country, year) references TB_Fatality(country, year)
);